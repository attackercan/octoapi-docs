[[{"l":"Документация ScanFactory","p":["Платформа ScanFactory проводит автоматизированное сканирование внешней сетевой инфраструктуры и вебсайтов Заказчика на предмет выявления уязвимостей методом «чёрного» и «серого» ящика с помощью 21 сканеров безопасности."]}],[{"l":"Быстрый старт","p":["С помощью данной статьи вы сможете оценить функционал и возможности решения. Записаться на тестирование решения вы можете по ссылке: https://scan-factory.ru"]},{"l":"1. Создайте и запустите новый проект","p":["Перейдя во вкладку Мои проекты нажмите на кнопку Создать проект.","Рис. 1.1","Заполните появившуюся форму. Укажите имя проекта, режим сканирования целей (ПЕРИМЕТР, WEB, OSINT, MICROSCAN, LIGHT SCAN: они различаются набором сканеров, по умолчанию ПЕРИМЕТР - все сканеры включены), цели сканирования: хотя бы один домен, вайлдкард, IP или подсеть. Подробнее о этапах сканирования в разделе Технический Обзор.","Режимы:","Периметр - по умолчанию, включает в себя все сканеры для общего сканирования активов Внутренняя сеть - сканирование внутренней сети на On-premise инсталляции раз в неделю OSINT - сканирование активов с разведкой по открытым источникам Metascan - сканирование только с помощью opensource инструментов Веб - сканирование веб приложений","Рис. 1.2","В этом окне будут дополнительные настройки сканирования, которые можно будет менять и после создания проекта. Например, период сканирования, по умолчанию проект будет запущен всегда:","Рис. 1.2.1","Нажмите на кнопку Создать проект после внесения интересующих вас изменений. Новый проект будет на паузе, пока вы не запустите его из вкладки Мои проекты."]},{"l":"2. Настройте проект","p":["*.sub.domain.com","Blacklist скоупа: черный список, где могут быть указаны домены, вайлдкарды, регулярные выражения (для доменов), IPv4 адреса и подсети и регулярные выражения для HTTP ссылок. Примеры:","domain.com","https?://domain.com/foo/\\w+","IP и подсети: адреса IPv4 и подсети (например, 11.22.33.44/24).","re:xyz.u\\d+.domain.com","Более подробную информацию о сканерах и их настройке можно найти в разделах Список используемых сканеров и Решение проблем.","Вы можете провести тонкую конфигурацию запускаемых сканеров. Подробнее об этом - в разделе Технический обзор ScanFactory","Домены: домены (например, yandex.ru) и вайлдкарды (например, *.yandex.ru). Вайлдкард *.yandex.ru означает, что сканированию подлежит домен yandex.ru и все его поддомены.","Исключения из blacklist-a: Здесь можно указать исключения из черного списка. Могут быть указаны домены, вайлдкарды, регулярные выражения (для доменов), IPv4 адреса и подсети и регулярные выражения для HTTP ссылок.","На этой странице вы можете:","настраивать и создавать шаблоны сканирований отдельно для каждого инструмента.","Настройки шаблонов сканирования:","Переключатель \"Ручное подтверждение новых активов, которые не входят в скоуп\" означает, ни один домен не будет просканирован пока его IP-адреса не будут занесены вами в IP и подсети. Используйте её, чтобы сканирование не шло по ресурсам, которые расположены на IP-адресах сторонних организаций.","По умолчанию будут запущены все шаблоны. У каждого шаблона есть таймаут, максимальное время за которое одна задача должна быть завершена или время, после которого сканирование будет завершено с ошибкой, перезапуск, время, спустя которое сканер, связанный с данным шаблоном, заново начнет сканировать уязвимости. Например, перезапуск infrascan - 1 день: после выполнения всех задач этим сканером, повторное сканирование он будет выполнять только через 1 день.","Предварительный Ping серверов: Scanfactory будет предварительно проверять доступность указанных адресов и доменов перед сканированием, если ресурс недоступен, сканирование по нему не будет выполняться.","Развернутые инструкции по настройке можно найти в разделе Технический обзор.","редактировать черные списки для http-ссылок, доменов и IP;","Рис. 2.1","Рис. 2.2","Ручное подтверждение новых активов \"Включено\" - добавляйте IP адреса интересующих Вас доменов вручную, иначе они не будут просканированы. Ручное подтверждение новых активов \"Выключено\" (по умолчанию) - IP адреса доменов проекта будут заноситься в скоуп автоматически.","скачать отчет о найденных уязвимостях и сканировании по выбранному проекту","Сразу после создания проекта перед вами откроются его настройки:","указывать временной интервал для проведения сканирований (например, только 1:00-5:00 утра каждый день, кроме выходных);"]},{"l":"3. Боковая панель","p":["Рис. 3.1","На боковой панели вы можете найти все разделы, необходимые для управления. Мои проекты, Дашборд, Угрозы, Активы, SSL-сертификаты, HTTP-запросы, История проверок, а также Настройки проекта и ссылка на данную документацию."]},{"l":"4. Дашборд","p":["Рис. 4.1","На данной странице отображена сводная статиска по выбранному проекту или системе."]},{"l":"5. Угрозы","p":["Рис. 5.1 Функционал раздела \"Угрозы\" позволяет:","Просматривать все обнаруженные уязвимости;","Управлять статусом уязвимостей;","Выполнять поиск и фильтрацию уязвимостей по заданным параметрам;","Просмотреть подробную информацию об уязвимости в карточке уязвимости;","Выгрузить события в формате JSON.","Нажав на название уязвимости возможно перейти на карточку уязвимости, и получить подробную информацию о ней. В карточке уязвимости указаны:","Название","Дата обнаружения","Компонент, который обнаружил уязвимость","Статус","Уровень важности","Описание","Шаги по воспроизведению","Рис. 5.2"]},{"l":"6. Активы","p":["Активы - страница, которая отображает текущее состояние инфраструктуры Заказчика.","После окончания сканирования на странице Активов будут отображены найденные IP, порты и домены. Важные записи на странице можно закреплять. Отчет об активе можно скачать, нажав на соответствующую кнопку в колонке Отчет. Для доменов доступны скриншоты страницы для стандартных портов, отчеты сканера dirsearch доступны по нажатию на интересующий найденный порт, и отчеты по активу, как и для IP.","Рис. 6.1"]},{"l":"7. SSL-сертификаты","p":["На этой странице показаны найденные SSL-сертификаты, для какого они хоста, на каких портах, кем сертификат выдан, алгоритм шифрования, размер ключа и дата истечения сертификата.","Рис. 7.1"]},{"l":"8. HTTP-запросы","p":["На этой странице показаны все запросы к найденным доменам, коды ответа, путь, на который был отправлен запрос, хост и порт. При нажатии на запрос вы увидите дополнительную информацию, подробности запроса и ответа.","Рис. 8.1"]},{"l":"9. История проверок","p":["На данной странице вы найдете все проверки, производимые сканерами. Таблица поддерживает фильтрацию по шаблону, по статусам сканов, времени создания и обновления задачи, а также поиск по хостам.","Рис. 9.1"]},{"l":"10. Подключение телеграм-бота","p":["Начните диалог с телеграм-ботом: @scanfactory_reporter_bot","Подключите бота к вашему Личному Кабинету с помощью команды:/connect https://yx-client.scanfactory.io/api/ token TOKEN","Рабочий токен вы можете получить, связавшись с технической поддержкой."]}],[{"l":"Технический обзор ScanFactory"},{"l":"Вступление","p":["На этой странице подробно описаны используемые инструменты и возможные параметры запуска."]},{"l":"Этапы сканирования","p":["Платформа проводит сканирование внешнего периметра в 3 логических этапа:","№","Описание этапа","Результат работы","1","Сбор активов (OSINT)","Перечень доменов и IP, принадлежащих Заказчику","2","Сканирование сетевых сервисов","Определение открытых портов и сервисов; поиск известных CVE; брутфорс аутентификации на сетевых сервисах (FTP, SSH, Telnet, и др)","3","Сканирование веб-приложений","Краулинг веб-сайтов; поиск скрытых файлов и папок; поиск уязвимостей","Для примера рассмотрим сканирование Компании со следующими входными данными: Домены, принадлежащие компании: *.company.ru IP, принадлежащие компании: 11.22.33.44/23"]},{"i":"h3-этап-1-сбор-активов-osint-h3","l":"<h3>Этап 1. Сбор активов (OSINT)</h3>","p":["Доступен следующий набор инструментов:","amass и subfinder- Пассивный поиск поддоменов по открытым источникам altdns- Рекурсивный брутфорс поддоменов по словарю (словарь по умолчанию - 1000 слов) sdto- Проверка перехватов поддомена. Opensource инструмент собственной разработки","Пример работы:","amass нашёл домен 2 домена: www.company.ru(3 уровня) и домен sub.dev.company.ru(4 уровня). Оба домена добавлены в БД, и отображаются на вкладке Активы","altdns запустит брутфорс поддоменов на 3 уровень *.company.ru(т.к. в настройках был указан wildcard 3 уровня), а также *.dev.company.ru(т.к. домен 4 уровня был найден с помощью amass). Для этого создаётся 2 списка потенциальных доменов, и осуществляется резолв доменов с помощью инструмента massdns, публичных резолверов Yandex и Google, со скоростью 1000 запросов в секунду.","На каждый найденный поддомен запускается проверка перехвата поддоменов с помощью инструмента sdto"]},{"i":"h3-этап-2-сканирование-сетевых-сервисов-h3","l":"<h3>Этап 2. Сканирование сетевых сервисов</h3>","p":["Выбранные шаблоны инструментов будут запущены на все IP из диапазона 11.22.33.44/23, а также на все IP, в которые резолвятся обнаруженные домены из Этапа 1.","Доступен следующий набор инструментов: nmap- поиск открытых портов, а также определение версий сервисов infrascan- поиск известных CVE. База данных CVE является самой большой в мире, содержит более 65000 проверок, и обновляется каждый день brute- брутфорс паролей к сетевым сервисам по дефолтным словарям","При старте проекта создаётся 2 шаблона nmap: на топ-1000 портов; и на все 65535 портов. Также вы можете создать свой шаблон с нужными опциями nmap На каждый открытый порт определяется версия запущенного сервиса, и запускается поиск известных уязвимостей к этой версии сервиса с помощью сервиса Vulners","Так как и все наши заказчики, и мы находимся в России - а значит, ответы о том, закрыт порт или нет, мы будем получать быстро, то мы используем разумные настройки, которые выполняют скан даже быстрее, чем nmap timing option -Т4, и при этом выдают достоверный результат","Мы используем следующие настройки для nmap:","--max-rtt-timeout 600ms- максимальное время получения ответа от порта--min-rtt-timeout 10ms- минимальное время получения ответа от порта--initial-rtt-timeout 300ms- первоначальное время получения ответа (нмап сам меняет это значение, в рамках min/max опций выше)--host-timeout 110m- максимальное время сканирования IP = 1 час 50 минут--max-retries 3- количество повторных попыток на сканирование порта--max-scan-delay 100ms- максимальная задержка между отправкой повторных пакетов","С этими настройками 1000 портов на 1 сервере сканируются за 25 секунд. Таким образом, подсеть размера /23 (512 IP) на топ 1000 портов мы можем просканировать за 4,5 часа (имея 1 запущенную копию nmap)","Пример работы nmap обнаруживает открытый порт 22, и опредляет версию запущенного сервиса как OpenSSH 7.9. Сервер помечается как \"активный\", и информацию по этому сервису теперь можно увидеть на вкладке Активы Сервис Vulners сообщает, что версия OpenSSH устарела и имеет перечень уязвимостей, поэтому создаёт новую запись об этой Уязвимости infrascan запускает анализ каждого IP brute запускает брутфорс авторизаций на каждый открытый порт","При сканировании больших подсетей (более, чем /23) рекомендуем включать дополнительную настройку «Предварительный ping IP». В этом случае на каждый сервер отправляется команда nmap -sn IP, и на основе результата сервер будет отмечен как «Активный» или «Не активный». Далее, шаблоны инструментов будут запущены только на IP, определённые как «Активные»."]},{"i":"h3-этап-3-сканирование-веб-приложений-h3","l":"<h3>Этап 3. Сканирование веб-приложений</h3>","p":["Сканирование веб-приложений проходит в 3 этапа: сбор информации о веб-приложении, отсев «неинтересных» запросов, и поиск уязвимостей","Выбранные шаблоны инструментов будут запущены на все открытые порты:","crawler- обход веб-приложения с помощью headless Chrome краулера собственной разработки, а также сохранение скриншотов главной страницы crawlergo- обход страниц веб-приложений dirsearch- поиск скрытых файлов и папок на веб-сервере Результат работы – набор GET/POST запросов, которые передаются на следующий этап","Все обнаруженные запросы проходят через двухуровневую систему отсева «неинтересных» запросов: Уровень 1. Отсев ссылок с похожим форматом Пример. Во время краулинга интернет-магазина были найдены следующие ссылки:","Все имеющиеся ссылки имеют одинаковый паттерн: http://client.ru/products/book-[\\d]/","Как только в базу данных будет добавлено 50 (значение по умолчанию) ссылок с одинаковым паттерном, далее ссылки с таким же паттерном сохраняться не будут. В нашем примере будут сохранены только запросы к книгам с 1 по 50.","Уровень 2. Отсев страниц с похожим содержимым ScanFactory использует собственную технологию, основанную на SimHash, которая анализирует контент каждой веб-страницы перед сохранением в базу данных. В случае, если большое количество страниц имеет одинаковую HTML-структуру (например, страницы блога, или карточки товаров), такие страницы не сохраняются","На финальном этапе запускаются следующие шаблоны инструментов:","webscan- сканер OWASP Top 10 уязвимостей. Инструмент работает в режиме proxy nuclei- opensource сканер веб-приложений с набором публичных и приватных шаблонов. ffuf- поиск скрытых GET/POST параметров путём поиска аномалий в ответах сервера. На каждый имеющийся HTTP-запрос в базе данных инструмент отправляет более 1000 запросов (вида http://client.ru/api/?DEBUG=1, http://client.ru/api/ADMIN?=1, и другие). Мы рекомендуем включать этот инструмент, только если у вас в скоупе 1-5 веб-приложений, и НЕ включать его, если веб-приложений больше","Сканирование веб-приложений методом «серого ящика» Авторизация в веб-приложениях работает путём добавления авторизационных HTTP-заголовок к краулерам Для этого создайте новый шаблоны crawler и crawlergo с параметрами: extra_headers: {Cookie: a=b}(подставить сюда хэдеры, по которому приложение авторизует пользователя)","Так как указанные хэдеры будут добавляться ко всем запросам краулера, то нужно создавать отдельный проект под каждое веб-приложение, для которого настраивается авторизация"]}],[{"l":"Список используемых сканеров","p":["В этом разделе перечислены сканеры, используемые в ScanFactory"]},{"l":"Коммерческие сканеры","p":["Коммерческий Веб-сканер #1","Поиск уязвимостей на веб-сайтах методом чёрного ящика","Коммерческий Сканер Инфраструктуры","Поиск CVE-уязвимостей, PCI DSS сканирование"]},{"l":"OSINT"},{"i":"режим-пассивный-поиск","l":"Режим \"Пассивный поиск\"","p":["amass","Пассивный поиск поддоменов по платным и бесплатным источникам","subfinder"]},{"i":"режим-активный-поиск","l":"Режим \"Активный поиск\"","p":["goaltnds","Активный поиск поддоменов, методом брутфорса по словарю","alterx","Активный поиск поддоменов, методом пермутаций результатов","dnsx","Активный поиск поддоменов, очистка результатов методом резолвинга","massdns","Активный поиск поддоменов, очистка результатов методом резолвинга результатов"]},{"l":"Opensource инструменты","p":["brute","crawlergo","dirsearch","fuzzuli","grep","masscan","nmap","nuclei","OWASP ZAP","screenshooter","sdto","waybackurls","wpscan","x8","Анализ веб-страниц: поиск доменов, ссылок на подгружаемые js-файлы, и тд","Перебор паролей к веб-формам, а также сетевым сервисам ftp, ftps, mssql, postgres, radmin2, rdp, redis, amqp, smb, snmp, ssh, vnc, telnet","Поиск OWASP Top 10 уязвимостей на веб-сайтах","Поиск бэкапов веб-сайтов, на основе динамически генерируемого словаря","Поиск открытых портов","Поиск открытых портов и определение запущенных сервисов","Поиск популярных уязвимостей. Более 9000 плагинов. Регулярно разрабатываем собственные плагины","Поиск скрытых параметров в HTTP-запросах","Поиск скрытых файлов и папок","Поиск ссылок на этот домен в Wayback Machine","Поиск уязвимостей Wordpress","Проверка перехвата поддомена (собственная разработка)","Рекурсивный обход веб-сайтов, сбор HTTP-запросов","Создание скриншота главной страницы сайта (собственная разработка)"]}],[{"l":"Документация по API","p":["Актуальная документация по API находится по ссылке: https://ВАШ_ЛИЧНЫЙ_КАБИНЕТ.sf-cloud.ru/api/docs"]},{"i":"получить-авторизационный-токен-срок-жизни---12-часов","l":"Получить Авторизационный токен (срок жизни - 12 часов)"},{"i":"получить-годовой-авторизационный-токен-например-для-telegram-бота","l":"Получить Годовой Авторизационный токен (например, для Telegram-бота)"},{"l":"Получить список живых хостов","p":["/api/hosts/?alive=1hidden=0"]},{"l":"Параметры","p":["1","1 or 0","address","alive","all","Description","domain","domain string","hidden","include_dead_ports","int","IP string","limit","Parameter","pending","ports.port_number","project_id","skip","sort","string","True/1 or string/int","Value","Актуальный список параметров находится в Swagger в Вашем Личном Кабинете. Ссылка на Swagger: https://ВАШ_ЛИЧНЫЙ_КАБИНЕТ.sf-cloud.ru/api/docs","Включить в ответ порты, помеченные \"мёртвыми\", по умолчанию - 0","Если указано skip и limit игнорируется, запрашивает все хосты","Количество хостов, которое будет показано на одной странице","Количество хостов, которое будет пропущено для пагинации","Ниже приведён краткий пример, какие параметры возможно передать","Отображение скрытых хостов - всегда нужно передавать 0","Поиск живых или мертвых хостов","Поиск ожидающих хостов (True или 1), поиск активных (любое дргугое значение)","Поиск хостов с указанным ID проекта","Поиск хостов с указанным IP. Формат: 127.0.0.1","Поиск хостов с указанными доменными именами. Формат: 'google.com'","Поиск хостов с указанными портами","Сортировка хостов. Варианты: host, last_seen, mdate, alert_count. По умолчанию host. Каждое значение может быть с перфиксом -, что означает сортировку в обратном порядке: -last_seen"]},{"l":"Пример ответа"},{"l":"Получить уязвимости за неделю","p":["/api/alerts/?active=1limit=10000"]},{"l":"Параметры","p":["$gt-last_seen","1 or 0","active","Description","Parameter","project_id","sort","string","string(unix_timestamp)","string(uuid)","Value","Актуальный список параметров находится в Swagger в Вашем Личном Кабинете. Ссылка на Swagger: https://ВАШ_ЛИЧНЫЙ_КАБИНЕТ.sf-cloud.ru/api/docs","Ниже приведён краткий пример, какие параметры возможно передать","Поиск активных уязвимостей","Поиск уязвимостей, найденных, после указанной даты","Поиск язвимостей по указанному проекту","Сортировка хостов. Варианты: host, last_seen, mdate, alert_count. По умолчанию host. Каждое значение может быть с перфиксом -, что означает сортировку в обратном порядке: -last_seen"]},{"l":"Пример ответа"},{"l":"Добавление хостов в проект","p":["Чтобы добавить хосты в проект, необходимо выполнить POST запрос на https://CLIENT.sf-cloud.ru/api/projects/project_UUID/scope-extension/ Новые домены будут дописываться в конец уже существующего скоупа."]},{"l":"Body запроса"},{"l":"Код"},{"l":"Пример ответа"},{"l":"Удаление хостов из проекта","p":["Чтобы удалить хост из проекта, необходимо выполнить POST запрос на https://CLIENT.sf-cloud.ru/api/projects/project_UUID/scope-deletion"]},{"i":"body-запроса-1","l":"Body запроса"},{"i":"код-1","l":"Код"},{"l":"Пример ответа"}],[{"l":"Статусы задач","p":["Опубликована— Задача находится в очереди на исполнение.","В работе— Идёт сканирование","Завершена— Проверка успешно завершилась.","Провалена— По каким-либо причинам сканирование не завершилось успехом.","Таймаут— Таймаут между попытками перезапустить модуль. Скорее всего - произошла блокировка WAF","Другое— Статус не определён."]}],[{"l":"Алгоритм подсчёта лицензии"},{"i":"алгоритм-подсчёта-лицензии-1","l":"Алгоритм подсчёта лицензии","p":["Программное обеспечение лицензируется по количеству Живых хостов. Живой Хост - это либо IP-адрес с хотя бы 1 открытым TCP/UDP портом, либо доменное имя (FQDN), которое резолвится в IP-адрес с хотя бы 1 открытым портом."]},{"i":"алгоритм-подсчёта","l":"Алгоритм подсчёта:","p":["Суммируются уникальные записи \"живые IP + живые домены\" из всех Проектов в Личном Кабинете за последние 90 дней","Эта сумма пересчитывается в сторону Заказчика по формуле: \"если на 1 IP расположено 10 доменов, то это не (1 IP) + (10 доменов) = 11 хостов, а мы считаем, что это 10 хостов\""]},{"i":"пример","l":"Пример:","p":["www.site.ru, который резолвится в IP 1.2.3.4, и имеет один открытый порт 443 - это 1 живой хост, и 1 лицензия"]}],[{"l":"Решение проблем","p":["Здесь приведены возможные проблемы со сканированием и методы их решения"]},{"l":"Нет успешных сканов Dirsearch","p":["Эта проблема может возникнуть по ряду причин, самая распространенная - ваш сервер возвращает сканеру HTTP 429 из-за включенного рейт-лимитера.","Создать новый шаблон dirsearch, отключив старый","При создании указать параметры запуска Dirsearch поддерживает threads:int, timeout:float, max_rate:int, delay:float в формате param: 1.0, ...","threads- Количество потоков, в которых будут выполняться запросы к вашему сайту, по умолчанию 25","timeout- Таймаут на подключение к вашему сайту, по умолчанию 7.5 сек.","max_rate- Максильное к-во запросов в секунду к вашему сайту, по умолчанию выключено, сканер работает на полную мощность.","delay- Время сна сканера между запросами, указывается в секундах, по умолчанию выключено, задержки нет","Подобрать оптимальные значения для вашего сайта Например, если у вас лимит на 5 req/s, возможным оптимальным значением в параметрах запуска будет threads: 10, max_rate: 5, delay: 0.1 Что соответствует 5 запросам в секунду с паузой между ними в 0.1 с.","Не стоит ставить слишком низкие или высокие параметры, потому что это может сильно замедлить скан или повлиять на его успешность","Рекомендуется увеличить таймаут шаблона до 3000 секунд, чтобы нивелировать ограниченную производительность"]}],[{"i":"5---интеграции","l":"5 - Интеграции","p":["Здесь вы можете найти документацию по интеграции с внешними сервисами"]},{"l":"Список","p":["Интеграции Скрипт по скачиванию отчётов через API SF"]}],[{"l":"Интеграция с Defect Dojo","p":["Scanfactory позволяет экспортировать отчеты по уязвимостям из нашей системы в ваш Defect Dojo"]},{"l":"Установка и запуск","p":["Для работы необходим Python 3.11 и менеджер пакетов pip","Выполните команды:","При неудаче проверьте наличие и версии python3 и pip/pip3 и попробуйте снова","Внимательно прочитайте документацию и следуйте пунктам, указанным в ней"]},{"l":"Возможные проблемы","p":["Проблемы при первом запуске - сверьтесь с документацией, проверьте логи. При первом запуске рекомендуется видеть логи в консоли, включаются параметром --log-to-console","Проблемы с дедупликацией отчетов в Defect Dojo Настройки дедупликации DD находятся в Боковая панель -> Кнопка настроек -> System settings Если дедупликация все еще не работает: это может помочь"]}]]